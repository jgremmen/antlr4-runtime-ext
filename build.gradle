plugins {
  id 'java-library'
  id 'idea'
  id 'antlr'
  id 'maven-publish'
  id 'jacoco'
  id 'signing'
}


layout.buildDirectory = ".build"


description 'ANTLR4 Runtime Extensions'
group 'de.sayayi.lib'
version '0.4.1-SNAPSHOT'


def antlr4Version = "4.9.3"
def junitVersion = "5.10.0"
def lombokVersion = "1.18.+"
def jetbrainsAnnotationsVersion = "24.0.1"


configurations {
  mavenCompile { attributes.attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_API)) }
  mavenRuntime { attributes.attribute(Usage.USAGE_ATTRIBUTE, objects.named(Usage, Usage.JAVA_RUNTIME)) }

  implementation.extendsFrom mavenRuntime
  compileOnlyApi.extendsFrom mavenCompile
}


repositories {
  mavenCentral()
}


java {
  toolchain {
    languageVersion = JavaLanguageVersion.of(8)
  }
}


test {
  useJUnitPlatform()
}


apply from: file('gradle/javadoc.gradle')
apply from: file('gradle/publishing.gradle')


dependencies {
  // java
  mavenRuntime "org.antlr:antlr4-runtime:${antlr4Version}"

  mavenCompile "org.jetbrains:annotations-java5:${jetbrainsAnnotationsVersion}"

  // test
  testAnnotationProcessor "org.projectlombok:lombok:${lombokVersion}"

  testCompileOnly "org.projectlombok:lombok:${lombokVersion}"
  testCompileOnly "org.jetbrains:annotations-java5:${jetbrainsAnnotationsVersion}"

  testImplementation "org.junit.jupiter:junit-jupiter-api:${junitVersion}"
  testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:${junitVersion}"
  testRuntimeOnly "org.junit.platform:junit-platform-launcher"

  antlr "org.antlr:antlr4:${antlr4Version}"
}
